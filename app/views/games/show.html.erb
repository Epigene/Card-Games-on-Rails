<h1><%= @game.name.to_s %></h1>

<% if @game.rounds.empty? %>
  <%= "Players in Game: #{@game.players.map{|p| [p.username, p.total_score]}}"%><br /><br />
<% else %>
  <%= "Players in Game: #{@game.players.map{|p| [p.username, p.round_score, p.total_score]}}"%><br /><br />
<% end %>
<%= button_to "Fill The Game", fill_game_path(@game) %>
<%= button_to "New Round", deal_cards_game_path(@game) %>
<%= button_to "Play 13 Tricks", play_trick_game_path(@game) %>
<%= button_to "Update Scores", update_scores_game_path(@game) %>

<% if @game.game_over? %>
  <h3>GAME'S OVER!!! The winner is <%= @game.winner.username %></h3><br />
<% else %>
  <% if @game.rounds.any? && @game.last_round.tricks.any? %>
    <h3>Last Trick</h3>
    <% @last_trick = @game.last_round.last_trick %>
    <% @cards = @last_trick.played_cards %>
    <% @cards.each do |card| %>
      <%= card.in_english + " from " + card.player.username %><br />
    <% end %>
    <br />
    Trick was lead by <%= @last_trick.leader.username %>, and won by <%= @last_trick.trick_winner.username %><br />
    The lead suit was <%= @last_trick.lead_suit.pluralize %>
  
  <% end %>
  

  <div class="span4">
  <h3>Your Hand:</h3>
  <div class="mytable">
    <table class="table table-striped">
      <tbody>
        <% current_user.hand.each do |card| %>
        <tr>
          <td>
            <%= card.in_english %>
          </td>
        </tr>
        <% end %>
      </tbody>
    </table>
  </table>
  </div>
<% end %>

<%= link_to 'Back', games_path %> | 
<%= link_to 'Delete', @game, method: :delete, data: { confirm: 'Are you sure?' } %>